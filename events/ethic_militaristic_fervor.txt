namespace = ethic_militaristic_fervor

# 摧毁敌舰
# Menace Objective - Destroy Enemy Ships
country_event = {
	id = ethic_militaristic_fervor.1
	hide_window = yes
	is_triggered_only = yes

	# This = owner of ship 1 (combatant)
	# From = owner of ship 2 (destroyed)
	# FromFrom = ship 1
	# FromFromFrom = ship 2

	trigger = {
		owner = {
			any_situation = {
				is_situation_type = situation_militaristic_fervor
			}
		}

		# check to exclude starbase kills in the future;
		# right now they're included and the starbase kill objective does nothing,
		# as the menace reward is the same

		fromfrom = {
			OR = {
				NOT = { is_ship_class = shipclass_starbase }
				fleet = { is_mobile = yes } #juggernauts
			}
		}
	}

	immediate = {
		owner = {
			random_situation = {
				limit = {
					is_situation_type = situation_militaristic_fervor
				}
				add_situation_progress = -1
			}
		}
	}
}

# 自己战舰被摧毁
# Menace Objective - Destroy Enemy Ships
country_event = {
	id = ethic_militaristic_fervor.2
	hide_window = yes
	is_triggered_only = yes

	# This = owner of ship 1 (destroyed)
	# From = owner of ship 2 (combatant)
	# FromFrom = ship 1
	# FromFromFrom = ship 2

	trigger = {
		owner = {
			any_situation = {
				is_situation_type = situation_militaristic_fervor
			}
		}

		# check to exclude starbase kills in the future;
		# right now they're included and the starbase kill objective does nothing,
		# as the menace reward is the same

		fromfrom = {
			OR = {
				NOT = { is_ship_class = shipclass_starbase }
				fleet = { is_mobile = yes } #juggernauts
			}
		}
	}

	immediate = {
		owner = {
			random_situation = {
				limit = {
					is_situation_type = situation_militaristic_fervor
				}
				add_situation_progress = 1
			}
		}
	}
}

# 征服星球
# Menace Objective - Conquer Worlds
# Fired from on_action 'on_planet_conquer'
planet_event = {
	id = ethic_militaristic_fervor.3
	hide_window = yes
	is_triggered_only = yes

	# From = Country scope (new owner)
	# This = Planet scope

	trigger = {
		from = {
			any_situation = {
				is_situation_type = situation_militaristic_fervor
			}
		}
		OR = {
			is_colony = yes
			AND = {
				exists = owner
				owner = {
					is_primitive = yes
				}
			}
		}
	}

	immediate = {
		every_owned_pop = {
			from = {
				random_situation = {
					limit = {
						is_situation_type = situation_militaristic_fervor
					}
					add_situation_progress = -1
				}
			}
		}
	}
}

# 自己星球被征服
# Menace Objective - Conquer Worlds
# Fired from on_action 'on_planet_conquer'
planet_event = {
	id = ethic_militaristic_fervor.4
	hide_window = yes
	is_triggered_only = yes

	# From = Country scope (new owner)
	# This = Planet scope

	trigger = {
		fromfrom = {
			any_situation = {
				is_situation_type = situation_militaristic_fervor
			}
		}
		OR = {
			is_colony = yes
			AND = {
				exists = owner
				owner = {
					is_primitive = yes
				}
			}
		}
	}

	immediate = {
		every_owned_pop = {
			fromfrom = {
				random_situation = {
					limit = {
						is_situation_type = situation_militaristic_fervor
					}
					add_situation_progress = 1
				}
			}
		}
	}
}

country_event = {
	id = ethic_militaristic_fervor.5
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_ethic = ethic_fanatic_militarist
		is_at_war = no
		is_country_type = default
		from = { is_country_type = default }
	}

	immediate = {
		if = {
			limit = {
				has_ethic = ethic_fanatic_militarist
			}
			country_event = {
				id = ethic_militaristic_fervor.6
				days = 14
				scopes = { from = from }
			}
		}
	}
}

country_event = { # Finishing First Contact
	id = ethic_militaristic_fervor.6
	title = ethic_militaristic_fervor.6.name
	desc = ethic_militaristic_fervor.6.desc

	location = event_target:target_system

	picture = GFX_evt_machine_space_battle
	show_sound = event_ship_explosion

	is_triggered_only = yes

	trigger = {
		From = { is_country_type = default }
		has_ethic = ethic_fanatic_militarist
		capital_scope = {
			closest_system = {
				limit = {
					exists = space_owner
					space_owner = {
						is_same_value = from
					}
					any_system_planet = {
						NOT = { is_capital = yes }
					}
				}
				max_steps = 20
			}
		}
	}

	immediate = {
		set_country_flag = encountered_alien_life
		set_country_flag = finished_sapient_first_contact
		capital_scope = {
			closest_system = {
				limit = {
					exists = space_owner
					space_owner = {
						is_same_value = from
					}
					any_system_planet = {
						NOT = { is_capital = yes }
					}
				}
				max_steps = 20
				save_event_target_as = target_system
			}
		}
	}

	option = { #Stop them and Apologize
		name = ethic_militaristic_fervor.6.a
		from = {
			add_opinion_modifier = {
				who = root
				modifier = fotd_apoligized
			}
		}
		ai_chance = {
			base = 1
			modifier = {
				multiply = 0
				has_civic = civic_fanatic_purifiers
			}
			modifier = {
				multiply = 0
				has_civic = civic_sparta_spirit
			}
		}
	}
	option = { #Explosion happens, reprimand Seperatists
		name = ethic_militaristic_fervor.6.b
		custom_tooltip = origin.6045.starbase_destroyed.tt
		from = {
			add_opinion_modifier = {
				who = root
				modifier = fotd_destroyed_starbase
			}
		}
		hidden_effect = {
			event_target:target_system = {
				starbase.fleet = { destroy_fleet = this }
			}
			from = {
				country_event = { id = origin.6046 } #They blew up our starbase!
			}
		}
		ai_chance = {
			base = 1
			modifier = {
				multiply = 0
				has_civic = civic_fanatic_purifiers
			}
			modifier = {
				multiply = 0
				has_civic = civic_sparta_spirit
			}
		}
	}
	option = { #Use this chance
		allow = {
			is_pacifist = no
		}
		name = ethic_militaristic_fervor.6.c
		if = {
			limit = {
				NOT = {
					any_situation = {
						is_situation_type = situation_militaristic_fervor
					}
				}
			}
			custom_tooltip = ethic_militaristic_fervor.6.c.tt
		}
		else = {
			custom_tooltip = ethic_militaristic_fervor.6.c.tt.2
		}
		hidden_effect = {
			event_target:target_system = {
				starbase.fleet = { destroy_fleet = this }
			}
			set_visited = event_target:target_system
			declare_war = {
				target = from
				attacker_war_goal = wg_fotd_really_bad_contact
			}
			create_fleet = {
				effect = {
					set_owner = root
					while = {
						count = 5
						create_ship = {
							name = random
							random_existing_design = corvette
						}
					}
					set_location = event_target:target_system
					set_cloaking_active = yes
				}
			}
			if = {
				limit = {
					NOT = {
						any_situation = {
							is_situation_type = situation_militaristic_fervor
						}
					}
				}
				custom_tooltip = ethic_militaristic_fervor.6.c.tt
				start_situation = {
					type = situation_militaristic_fervor
					target = root
				}
				set_ai_personality = warmonger
			}
			from = {
				add_opinion_modifier = {
					who = root
					modifier = fotd_destroyed_starbase
				}
			}
			from = {
				country_event = { id = origin.6047 } #They blew up our starbase and declared war!
			}
		}
		ai_chance = {
			base = 1
		}
	}
}

country_event = {
	id = ethic_militaristic_fervor.7
	is_triggered_only = yes
	title = ethic_militaristic_fervor.7.name
	desc = ethic_militaristic_fervor.7.desc
	picture = GFX_evt_open_revolt
	immediate = {
		save_event_target_as = from_country
		random_owned_planet = {
			limit = {
				is_capital = no
			}
			save_event_target_as = rebel_country_capital
			create_country = {
				name = random
				type = default
				species = prev.owner_species
				ignore_initial_colony_error = yes
				day_zero_contact = no
				ethos = { ethic = ethic_fanatic_militarist ethic = random }
				civics = random
				origin = origin_separatists
				flag = random
				effect = {
					save_event_target_as = rebel_country
					establish_contact = { who = root location = root }
					establish_communications_no_message = root
					root = {
						every_owned_planet = {
							limit = { is_capital = no }
							random_list = {
								1 = {}
								1 = {
									set_owner = event_target:rebel_country
									set_controller = event_target:rebel_country
									solar_system = {
										every_fleet_in_system = {
											set_owner = event_target:rebel_country
											set_controller = event_target:rebel_country
										}
										every_neighbor_system = {
											limit = {
												NOT = {
													any_system_planet = {
														is_colony = yes
													}
												}
											}
											every_fleet_in_system = {
												set_owner = event_target:rebel_country
												set_controller = event_target:rebel_country
											}
										}
									}
								}
							}
						}
						create_leader = {
							species = event_target:rebel_country.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = official
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = scientist
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						event_target:rebel_country = {
							assign_leader = last_created_leader
						}
					}
					event_target:rebel_country = {
						copy_techs_from = {
							target = root
						}
						add_basic_resources_effect = { VALUE = 30000 }
						add_manufactured_resources_effect = { VALUE = 15000 }
						add_advanced_resources_effect = { VALUE = 1000 }
						create_fleet_from_naval_cap = 0.4
						random_system_within_border = {
							last_created_fleet = {
								set_location = prev
							}
						}
						reroll_random = yes
						create_fleet_from_naval_cap = 0.6
						random_system_within_border = {
							last_created_fleet = {
								set_location = prev
							}
						}
						reroll_random = yes
						create_fleet_from_naval_cap = 0.8
						random_system_within_border = {
							last_created_fleet = {
								set_location = prev
							}
						}
						reroll_random = yes
						create_fleet_from_naval_cap = 1.2
						random_system_within_border = {
							last_created_fleet = {
								set_location = prev
							}
						}
						random_owned_planet = {
							last_created_fleet = {
								set_location = event_target:rebel_country_capital
							}
						}
						declare_war = {
							target = root
							name = {
								key = NAME_Imperial_War
							}
							attacker_war_goal = "wg_imperial_war"
						}
						start_situation = {
							type = situation_militaristic_fervor
							target = this
						}
						set_ai_personality = warmonger
					}
				}
			}
		}
	}
	option = {
		name = ethic_militaristic_fervor.7.a
		custom_tooltip = ethic_militaristic_fervor.7.tooltip
	}
}

country_event = {
	id = ethic_militaristic_fervor.8
	is_triggered_only = yes
	title = ethic_militaristic_fervor.8.name
	desc = ethic_militaristic_fervor.8.desc
	picture = GFX_evt_open_revolt
	immediate = {
		add_modifier = {
			modifier = paragon_origin_one_system_war
			days = 3600
		}
	}
	option = {
		name = ethic_militaristic_fervor.8.a
		custom_tooltip = ethic_militaristic_fervor.8.tooltip
	}
}

country_event = {
	id = ethic_militaristic_fervor.9
	is_triggered_only = yes
	title = ethic_militaristic_fervor.9.name
	desc = ethic_militaristic_fervor.9.desc
	picture = GFX_evt_open_revolt
	immediate = {
		random_owned_planet = {
			limit = {
				is_capital = no
			}
			save_event_target_as = rebel_country_capital_1
			create_country = {
				name = random
				type = default
				species = prev.owner_species
				ignore_initial_colony_error = yes
				day_zero_contact = no
				authority = auth_oligarchic
				ethos = { ethic = ethic_fanatic_militarist ethic = random }
				civics = random
				flag = random
				effect = {
					save_event_target_as = rebel_country_1
					establish_contact = { who = root location = root }
					establish_communications_no_message = root
					event_target:rebel_country_1 = {
						copy_techs_from = {
							target = root
						}
						add_basic_resources_effect = { VALUE = 30000 }
						add_manufactured_resources_effect = { VALUE = 15000 }
						add_advanced_resources_effect = { VALUE = 1000 }
						create_leader = {
							species = event_target:rebel_country_1.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = official
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_1.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = scientist
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_1.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_1.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_1.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						event_target:rebel_country_1 = {
							assign_leader = last_created_leader
						}
						event_target:rebel_country_capital_1 = {
							set_capital = yes
							solar_system = {
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_1
									set_controller = event_target:rebel_country_1
								}
								every_neighbor_system = {
									limit = {
										NOT = {
											any_system_planet = {
												is_colony = yes
											}
										}
									}
									every_fleet_in_system = {
										set_owner = event_target:rebel_country_1
										set_controller = event_target:rebel_country_1
									}
								}
							}
						}
					}
				}
			}
		}
		random_owned_planet = {
			limit = {
				is_capital = no
			}
			save_event_target_as = rebel_country_capital_2
			create_country = {
				name = random
				type = default
				species = prev.owner_species
				ignore_initial_colony_error = yes
				day_zero_contact = no
				authority = auth_dictatorial
				ethos = { ethic = ethic_fanatic_militarist ethic = random }
				civics = random
				flag = random
				effect = {
					save_event_target_as = rebel_country_2
					establish_contact = { who = root location = root }
					establish_communications_no_message = root
					event_target:rebel_country_2 = {
						copy_techs_from = {
							target = root
						}
						add_basic_resources_effect = { VALUE = 30000 }
						add_manufactured_resources_effect = { VALUE = 15000 }
						add_advanced_resources_effect = { VALUE = 1000 }
						create_leader = {
							species = event_target:rebel_country_2.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = official
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_2.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = scientist
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_2.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_2.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_2.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						event_target:rebel_country_2 = {
							assign_leader = last_created_leader
						}
						event_target:rebel_country_capital_2 = {
							set_capital = yes
							solar_system = {
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_2
									set_controller = event_target:rebel_country_2
								}
								every_neighbor_system = {
									limit = {
										NOT = {
											any_system_planet = {
												is_colony = yes
											}
										}
									}
									every_fleet_in_system = {
										set_owner = event_target:rebel_country_2
										set_controller = event_target:rebel_country_2
									}
								}
							}
						}
					}
				}
			}
		}
		random_owned_planet = {
			limit = {
				is_capital = no
			}
			save_event_target_as = rebel_country_capital_3
			create_country = {
				name = random
				type = default
				species = prev.owner_species
				ignore_initial_colony_error = yes
				day_zero_contact = no
				authority = auth_imperial
				ethos = { ethic = ethic_fanatic_militarist ethic = random }
				civics = random
				flag = random
				effect = {
					save_event_target_as = rebel_country_3
					establish_contact = { who = root location = root }
					establish_communications_no_message = root
					event_target:rebel_country_3 = {
						copy_techs_from = {
							target = root
						}
						add_basic_resources_effect = { VALUE = 30000 }
						add_manufactured_resources_effect = { VALUE = 15000 }
						add_advanced_resources_effect = { VALUE = 1000 }
						create_leader = {
							species = event_target:rebel_country_3.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = official
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_3.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = scientist
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_3.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_3.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						create_leader = {
							species = event_target:rebel_country_3.owner_main_species
							leader_age_min = 18
							leader_age_max = 30
							class = commander
							skill = 10
						}
						event_target:rebel_country_3 = {
							assign_leader = last_created_leader
						}
						event_target:rebel_country_capital_3 = {
							set_capital = yes
							solar_system = {
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_3
									set_controller = event_target:rebel_country_3
								}
								every_neighbor_system = {
									limit = {
										NOT = {
											any_system_planet = {
												is_colony = yes
											}
										}
									}
									every_fleet_in_system = {
										set_owner = event_target:rebel_country_3
										set_controller = event_target:rebel_country_3
									}
								}
							}
						}
					}
				}
			}
		}
		root = {
			every_owned_planet = {
				limit = { is_capital = no }
				random_list = {
					1 = {}
					1 = {
						set_owner = event_target:rebel_country_1
						set_controller = event_target:rebel_country_1
						solar_system = {
							every_fleet_in_system = {
								set_owner = event_target:rebel_country_1
								set_controller = event_target:rebel_country_1
							}
							every_neighbor_system = {
								limit = {
									NOT = {
										any_system_planet = {
											is_colony = yes
										}
									}
								}
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_1
									set_controller = event_target:rebel_country_1
								}
							}
						}
					}
					1 = {
						set_owner = event_target:rebel_country_2
						set_controller = event_target:rebel_country_2
						solar_system = {
							every_fleet_in_system = {
								set_owner = event_target:rebel_country_2
								set_controller = event_target:rebel_country_2
							}
							every_neighbor_system = {
								limit = {
									NOT = {
										any_system_planet = {
											is_colony = yes
										}
									}
								}
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_2
									set_controller = event_target:rebel_country_2
								}
							}
						}
					}
					1 = {
						set_owner = event_target:rebel_country_3
						set_controller = event_target:rebel_country_3
						solar_system = {
							every_fleet_in_system = {
								set_owner = event_target:rebel_country_3
								set_controller = event_target:rebel_country_3
							}
							every_neighbor_system = {
								limit = {
									NOT = {
										any_system_planet = {
											is_colony = yes
										}
									}
								}
								every_fleet_in_system = {
									set_owner = event_target:rebel_country_3
									set_controller = event_target:rebel_country_3
								}
							}
						}
					}
				}
			}
		}
		event_target:rebel_country_1 = {
			create_fleet_from_naval_cap = 0.4
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.6
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.8
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 1.2
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			declare_war = {
				target = root
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			start_situation = {
				type = situation_militaristic_fervor
				target = this
			}
			set_ai_personality = warmonger
		}
		event_target:rebel_country_2 = {
			create_fleet_from_naval_cap = 0.4
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.6
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.8
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 1.2
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			declare_war = {
				target = root
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			declare_war = {
				target = event_target:rebel_country_1
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			start_situation = {
				type = situation_militaristic_fervor
				target = this
			}
			set_ai_personality = warmonger
		}
		event_target:rebel_country_3 = {
			create_fleet_from_naval_cap = 0.4
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.6
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 0.8
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			reroll_random = yes
			create_fleet_from_naval_cap = 1.2
			random_system_within_border = {
				last_created_fleet = {
					set_location = prev
				}
			}
			declare_war = {
				target = root
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			declare_war = {
				target = event_target:rebel_country_1
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			declare_war = {
				target = event_target:rebel_country_2
				name = {
					key = NAME_Imperial_War
				}
				attacker_war_goal = "wg_imperial_war"
			}
			start_situation = {
				type = situation_militaristic_fervor
				target = this
			}
			set_ai_personality = warmonger
		}
	}
	option = {
		name = ethic_militaristic_fervor.9.a
		custom_tooltip = ethic_militaristic_fervor.9.tooltip
	}
}

#AI军国主义狂热，若舰队实力足够且和平，每年宣战最弱的邻居
country_event = {
	id = ethic_militaristic_fervor.12
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		any_situation = {
			is_situation_type = situation_militaristic_fervor
		}
		is_at_war = no
		used_naval_capacity_percent >= 0.8
		any_neighbor_country = {
			NOT = {
				has_truce = root
			}
		}
	}
	immediate = {
		ordered_neighbor_country = {
			order_by = trigger:fleet_power
			position = 0
			inverse = yes
			random_list = {
				1 = {
					root = {
						declare_war = {
							target = prev
							attacker_war_goal = wg_subjugation
						}
					}
				}
				1 = {
					root = {
						declare_war = {
							target = prev
							attacker_war_goal = wg_unrestricted_wars_eci
						}
					}
				}
			}
		}
	}
}