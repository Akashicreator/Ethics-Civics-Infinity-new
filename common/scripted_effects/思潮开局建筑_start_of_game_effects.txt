
toxic_knights_order_habitat_setup = {
	optimize_memory
	owner = {
		save_event_target_as = toxic_knights_owner
		add_research_option = tech_habitat_1

		if = {
			limit = {
				OR = {
					is_lithoid_empire = no
					is_catalytic_empire = yes
				}
			}
			give_technology = {
				tech = tech_eco_simulation
				message = no
			}
			give_technology = {
				tech = tech_hydroponics
				message = no
			}
		}
		else = {
			give_technology = {
				tech = tech_powered_exoskeletons
				message = no
			}
			give_technology = {
				tech = tech_space_mining_1
				message = no
			}
		}
	}

	while = { #they get the habitat + destruction
		count = 7
		random_owned_pop = { kill_pop = yes }
	}
	remove_district = district_city
	remove_district = district_farming
	remove_district = district_generator
	remove_building = building_commercial_zone

	add_deposit = d_toxic_god_blight_upon_the_land
	add_deposit = d_toxic_god_deitys_swarms
	add_deposit = d_toxic_god_pools_most_venemous
	add_deposit = d_toxic_god_pestilential_wasteland
	add_deposit = d_toxic_god_envenomed_seas

	solar_system = {
		random_system_planet = {
			limit = { has_planet_flag = toxic_knights_habitat }
			set_owner = event_target:toxic_knights_owner
			while = {
				count = 4
				create_pop = {
					species = owner_main_species
				}
			}
			set_planet_entity = {
				entity = "habitat_phase_02_entity"
				graphical_culture = event_target:toxic_knights_owner
			}
			set_planet_size = 6
			set_planet_flag = advanced_habitat
			set_colony_type = col_habitat_fortress

			add_district_and_planet_size_if_needed_effect = {
				district = district_orders_demesne
			}

			remove_building = building_hab_capital
			add_building = building_order_keep
		}
		every_system_planet = {
			limit = { has_deposit_for = shipclass_mining_station }
			create_mining_station = { owner = prevprev.owner }
		}
	}
}

civic_anarchism_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_anarchism_start
	}
	solar_system = {
		random_system_planet = {
			if = {
				limit = {
					exists = owner
					owner = {
						OR = {
							has_valid_civic = civic_anarchism
							has_valid_civic = civic_transcendental_communism
							has_valid_civic = civic_democracy_and_clean_government
						}
						NOR = {
							has_valid_civic = civic_OGAS
							has_valid_civic = civic_proletarian_culture
						}
					}
				}
				remove_building =  building_bureaucratic_1
				add_building = building_holo_theatres
			}
			if = {
				limit = {
					exists = owner
					owner = {
						OR = {
							has_valid_civic = civic_anarchism
							has_valid_civic = civic_transcendental_communism
							has_valid_civic = civic_democracy_and_clean_government
						}
						has_valid_civic = civic_proletarian_culture
					}
				}
				remove_building =  building_bureaucratic_1
				add_building = building_cultural_palace
			}
		}
	}
}

civic_OGAS_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_OGAS_start
	}
	solar_system = {
		random_system_planet = {
			limit = { 
				exists = owner
				owner = {
					OR = {
						has_valid_civic = civic_OGAS
					}
				}
			}
			remove_building =  building_bureaucratic_1
			add_building = building_planet_network_node
		}
	}
}

civic_barbaric_despoilers_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_barbaric_despoilers_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = {
					OR = {
						has_valid_civic = civic_barbaric_despoilers
					}
				}
			}
			remove_building =  building_bureaucratic_1
		}
	}
}

civic_proletarian_culture_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_proletarian_culture_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = {
					OR = {
						has_valid_civic = civic_proletarian_culture
					}
				}
			}
			remove_building =  building_holo_theatres
			add_building = building_cultural_palace
		}
	}
}

origin_wizarding_world_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_proletarian_culture_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = { has_origin = origin_wizarding_world }
			}
			remove_building =  building_research_lab_1
			add_building = building_mage_tower_1
		}
	}
}

civic_cybercap_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_cybercap_start
	}
	solar_system = {
		random_system_planet = {
			limit = { 
				exists = owner
				owner = {
					OR = {
						has_valid_civic = civic_cybercap
						has_valid_civic = civic_corporate_cybercap
					}
				}
			}
			remove_building =  building_bureaucratic_1
			add_building = building_information_tower
		}
	}
}

civic_anglers_lithoid_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_anglers_lithoid_start
	}
	solar_system = {
		random_system_planet = {
			limit = { 
				exists = owner
				owner = {
					OR = {
						has_valid_civic = civic_anglers_lithoid
						has_origin = origin_mining_machinery
					}
				}
			}
			while = {
				limit = { num_districts = { type = district_mining value > 0 } }
				remove_district = district_mining
				add_district_and_planet_size_if_needed_effect = {
					district = district_mining_uncapped
				}
			}
		}
	}
}

civic_machine_liberator_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_machine_liberator_start
	}
	solar_system = {
		random_system_planet = {
			limit = { 
				exists = owner
				owner = {
					has_valid_civic = civic_machine_liberator
				}
			}

			# 4 + 3 energy
			add_deposit = d_hot_springs
			add_deposit = d_searing_desert
			add_deposit = d_underwater_vent
			add_deposit = d_searing_desert
	
			# 4 + 3 mining
			add_deposit = d_veiny_cliffs
			add_deposit = d_ore_rich_caverns
			add_deposit = d_submerged_ore_veins
	
			# 3 farming
			add_deposit = d_lichen_fields
			add_deposit = d_fungal_caves
		}
	}
}

not_building_commercial_zone = {
	optimize_memory
	owner = {
		save_event_target_as = not_building_commercial_zone
	}
	solar_system = {
		random_system_planet = {
			limit = {
				has_building = building_commercial_zone
			}
			remove_building =  building_commercial_zone
			add_building = building_holo_theatres
		}
	}
}

civic_forever_with_us_start_set = {
	optimize_memory
	create_species = {
		homeworld = this
		name = this
		namelist = this
		class = this
		portrait = this
		traits = {
			#trait = trait_machine_unit
			trait = trait_vanguard_hive_mind
			trait = trait_unnatural
		}
		immortal = yes
	}
	last_created_species = {
		set_citizenship_type = {
			country = root.owner
			type = citizenship_full_machine
		}
		set_living_standard = {
			country = root.owner
			type = living_standard_hive_mind
		}
		save_event_target_as = forever_species
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = {
					has_civic = civic_forever_with_us
				}
			}
			
			while = {
				count = 3
				random_owned_pop = {
					kill_pop = yes
				}
			}
			while = {
				count = 3
				create_pop = {
					species = event_target:forever_species
				}
			}
			
		}
	}
}

civic_environmentalist_corporate_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_environmentalist_corporate_start
	}
	solar_system = {
		random_system_planet = {
			if = {
				limit = {
					exists = owner
					owner = {
						OR = {
							has_valid_civic = civic_environmentalist_corporate
							has_valid_civic = civic_keepers_harmony
						}
					}
				}
				add_building = building_ranger_lodge
				add_blocker = { type = d_big_nature_preserve_blocker }
			}
			else_if = {
				limit = {
					exists = owner
					owner = { has_valid_civic = civic_environmentalist }
				}
				remove_deposit = d_big_nature_preserve_blocker
			}
		}
	}
}

civic_vilified_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_vilified_start
	}
	solar_system = {
		random_system_planet = {
			if = {
				limit = {
					exists = owner
					owner = { has_valid_civic = civic_vilified }
					planet = {
						has_building = building_research_lab_1
						NOR = {
							has_building = building_research_lab_2
							has_building = building_research_lab_3
						}
					}
				}
				remove_building = building_research_lab_1
				add_building = building_archaeostudies_faculty
			}
			else_if = {
				limit = {
					exists = owner
					owner = { has_valid_civic = civic_vilified }
					planet = {
						has_building = building_research_lab_2
						NOT= { has_building = building_research_lab_3 }
					}
				}
				remove_building = building_research_lab_2
				add_building = building_archaeostudies_faculty
			}
			else_if = {
				limit = {
					exists = owner
					owner = { has_valid_civic = civic_vilified }
					planet = { has_building = building_research_lab_3 }
				}
				remove_building = building_research_lab_3
				add_building = building_archaeostudies_faculty
			}
		}
	}
}

civic_primitive_worship_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_primitive_worship_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = {
					has_valid_civic = civic_primitive_worship
				}
			}
			remove_all_districts = yes
			remove_building =  building_research_lab_1
			add_building = building_primitive_dwellings_eci
			add_building = building_primitive_mine_eci
			add_building = building_smithy
			add_building = building_bio_reactor
		}
	}
}

civic_thirteen_monkeys_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_thirteen_monkeys_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = { has_origin = origin_thirteen_monkeys }
			}
			remove_building = building_capital
			add_building = building_major_capital
			add_building = building_holo_theatres
			add_building = building_holo_theatres
			add_building = building_commercial_zone
			add_building = building_factory_1
			add_building = building_foundry_1

			remove_deposit = d_great_pacific_garbage_patch
			remove_deposit = d_failing_infrastructure_earth
			remove_deposit = d_decrepit_dwellings_earth
			remove_deposit = d_failing_infrastructure
			remove_deposit = d_failing_infrastructure
			remove_deposit = d_decrepit_dwellings

			if = {
				limit = { is_gestalt = no }
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_city
					}
				}
			}
			if = {
				limit = { is_hive_empire = yes }
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_hive
					}
				}
			}
			if = {
				limit = { is_machine_empire = yes }
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_nexus
					}
				}
			}

			if = {
				limit = { is_lithoid_empire = no }
				while = {
					count = 1
					add_district_and_planet_size_if_needed_effect = {
						district = district_farming
					}
				}
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_mining
					}
				}
			}
			if = {
				limit = { is_lithoid_empire = yes }
				while = {
					count = 3
					add_district_and_planet_size_if_needed_effect = {
						district = district_mining
					}
				}
			}

			while = {
				count = 2
				add_district_and_planet_size_if_needed_effect = {
					district = district_industrial
				}
			}
		}
	}
}

civic_true_yuht_start_buildings = {
	optimize_memory
	owner = {
		save_event_target_as = civic_true_yuht_start
	}
	solar_system = {
		random_system_planet = {
			limit = {
				exists = owner
				owner = { has_origin = origin_true_yuht }
			}
			clear_blockers = yes
			remove_all_buildings = yes
			remove_all_districts = yes

			add_deposit = d_ethic_space_industry_cluster

			if = {
				limit = { owner = { is_machine_empire = yes } }
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_nexus
					}
				}
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_industrial
					}
				}
			}
			if = {
				limit = { owner = { is_hive_empire = yes } }
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_hive
					}
				}
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_industrial
					}
				}
			}
			if = {
				limit = { owner = { is_gestalt = no } }
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_city
					}
				}
				while = {
					count = 10
					add_district_and_planet_size_if_needed_effect = {
						district = district_industrial
					}
				}
			}

			if = {
				limit = { owner = { is_gestalt = no } }
				add_building = building_system_capital
			}
			if = {
				limit = { owner = { is_hive_empire = yes } }
				add_building = building_hive_major_capital
			}
			if = {
				limit = { owner = { is_machine_empire = yes } }
				add_building = building_machine_system_capital
			}
			if = {
				limit = {
					owner = {
						has_valid_civic = civic_OGAS
					}
				}
				add_building = building_planetary_management_center
			}
			if = {
				limit = {
					owner = {
						OR = {
							has_valid_civic = civic_cybercap
							has_valid_civic = civic_corporate_cybercap
						}
					}
				}
				add_building = building_information_tower
			}
			if = {
				limit = {
					owner = {
						NOR = {
							has_valid_civic = civic_OGAS
							has_valid_civic = civic_cybercap
							has_valid_civic = civic_corporate_cybercap
							has_origin = origin_wizarding_world
						}
					}
				}
				add_building = building_research_lab_2
			}
			if = {
				limit = {
					owner = {
						has_origin = origin_wizarding_world
						NOR = {
							has_valid_civic = civic_OGAS
							has_valid_civic = civic_cybercap
							has_valid_civic = civic_corporate_cybercap
						}
					}
				}
				add_building = building_mage_tower_2
			}
			if = {
				limit = {
					owner = {
						is_gestalt = no
						OR = {
							NOT = { has_ethic = ethic_fanatic_socialism }
							has_ethic = ethic_fanatic_authoritarian
						}
					}
				}
				add_building = building_paradise_dome
			}
			if = {
				limit = {
					owner = {
						has_ethic = ethic_fanatic_socialism
						NOT = { has_ethic = ethic_fanatic_authoritarian }
					}
				}
				add_building = building_communal_housing_large
			}
			if = {
				limit = {
					owner = { is_hive_empire = yes }
				}
				add_building = building_expanded_warren
			}
			if = {
				limit = {
					owner = {
						is_machine_empire = yes
						NOT = { has_civic = civic_machine_servitor }
					}
				}
				add_building = building_drone_megastorage
			}
			if = {
				limit = { owner = { has_civic = civic_machine_servitor } }
				add_building = building_organic_paradise
			}
			add_building = building_automated_power_plant
			add_building = building_automated_power_plant
			add_building = building_automated_power_plant
			if = {
				limit = {
					owner = {
						is_lithoid_empire = no
						is_machine_empire = no
					}
				}
				add_building = building_automated_farm
				add_building = building_automated_farm
				add_building = building_automated_mine
			}
			if = {
				limit = {
					owner = { is_lithoid_empire = yes }
				}
				add_building = building_automated_mine
				add_building = building_automated_mine
				add_building = building_automated_mine
			}
			if = {
				limit = {
					owner = {
						is_machine_empire = yes
						NOR = {
							has_civic = civic_machine_servitor
							has_civic = civic_machine_assimilator
						}
					}
				}
				add_building = building_automated_power_plant
				add_building = building_automated_power_plant
				add_building = building_automated_mine
			}
			if = {
				limit = {
					owner = {
						OR = {
							has_civic = civic_machine_servitor
							has_civic = civic_machine_assimilator
						}
					}
				}
				add_building = building_automated_power_plant
				add_building = building_automated_farm
				add_building = building_automated_mine
			}
			add_building = building_automated_mine
			add_building = building_automated_mine
			add_building = building_automated_mine
			if = {
				limit = {
					owner = { is_lithoid_empire = yes }
				}
				add_building = building_automated_mine
				add_building = building_automated_mine
				add_building = building_automated_mine
			}
		}
	}
}